<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <div class="page-header">
            <h1>Admin</h1>
        </div>

        <h2>Create a New Choice Page</h2>
        <form action="{{ url_for('admin') }}" method="post">
            <div class="form-group">
                <label for="page_name">Page Name:</label>
                <input type="text" id="page_name" name="page_name" required>
            </div>
            <div class="form-group">
                <label for="projects">Projects (comma-separated):</label>
                <input type="text" id="projects" name="projects" required>
            </div>
            <div class="form-group">
                <label>Cap Type:</label>
                <input type="radio" id="soft_cap" name="cap_type" value="soft" checked>
                <label for="soft_cap">Soft</label>
                <input type="radio" id="hard_cap" name="cap_type" value="hard">
                <label for="hard_cap">Hard</label>
            </div>
            <div class="form-group">
                <label for="group_size">Group Size:</label>
                <input type="number" id="group_size" name="group_size" min="1" required>
            </div>
            <div class="form-group" id="variation_group">
                <label for="variation">Group Size Variation:</label>
                <input type="number" id="variation" name="variation" min="0" value="0">
            </div>
            <button type="submit" class="btn">Create Page</button>
        </form>

        <script>
            const softCapRadio = document.getElementById('soft_cap');
            const hardCapRadio = document.getElementById('hard_cap');
            const variationGroup = document.getElementById('variation_group');

            function toggleVariation() {
                if (softCapRadio.checked) {
                    variationGroup.style.display = 'block';
                } else {
                    variationGroup.style.display = 'none';
                }
            }

            softCapRadio.addEventListener('change', toggleVariation);
            hardCapRadio.addEventListener('change', toggleVariation);

            // Initial check
            toggleVariation();
        </script>

        <hr>

        <h2>Existing Pages</h2>
        <ul class="project-list">
            {% for page_id, page in pages.items() %}
                <li>
                    <div class="project-name">
                        <a href="{{ url_for('choice', page_id=page_id) }}">{{ page.name }}</a>
                    </div>
                    <div>
                        <a href="{{ url_for('results', page_id=page_id) }}" class="btn btn-secondary">Results</a>
                        {% if not page.closed %}
                            <form action="{{ url_for('close', page_id=page_id) }}" method="post" style="display: inline;">
                                <button type="submit" class="btn">Close</button>
                            </form>
                        {% else %}
                            (Closed)
                            <form action="{{ url_for('reopen', page_id=page_id) }}" method="post" style="display: inline;">
                                <button type="submit" class="btn">Reopen</button>
                            </form>
                        {% endif %}
                        <form action="{{ url_for('delete_page', page_id=page_id) }}" method="post" style="display: inline;">
                            <button type="submit" class="btn btn-danger">Delete</button>
                        </form>
                    </div>
                </li>
            {% endfor %}
        </ul>
    </div>
</body>
</html>